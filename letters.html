<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8" />
<title>üíå Briefe ‚Äì Note & Klappe animiert</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
  :root{
    --bg:#05353d; --paper:#fff; --text:#374151;
    --wrap:#f5edd1; --flap:#ecdeb8; --body:#e6cfa7;
    --accent:#f59e0b; --btn:#fbbf24; --btn-hover:#fcd34d;
    --seal:#fb18e3;
  }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:#fff;font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,sans-serif}
  header{max-width:1100px;margin:24px auto 8px;padding:0 16px}
  h1{margin:0 0 10px}
  .meta{opacity:.9;margin:0 0 10px}
  .actions{display:flex;gap:8px;flex-wrap:wrap}
  .btn{padding:10px 14px;border:0;border-radius:10px;font-weight:700;cursor:pointer}
  .btn.primary{background:#0a5c6d;color:#fff}
  .btn.primary:hover{background:#0d768b}
  .btn.light{background:#f3f4f6;color:#111}

  /* Grid */
  .grid{
    max-width:1100px; margin:18px auto 48px; padding:0 16px;
    display:grid; grid-template-columns:repeat(auto-fill, minmax(260px, 1fr));
    gap:18px;
  }

  /* Karte / Umschlag */
  .card{
    background:var(--wrap);
    border:2px solid var(--accent);
    border-radius:14px;
    padding:12px;
    color:#111;
    display:flex; flex-direction:column;
    gap:12px;
    transition:opacity .2s ease;
  }
  .card.locked{opacity:.35; pointer-events:none; filter:saturate(.45)}

  /* Umschlag-Box ‚Äì hier passiert die Action */
  .envelope{
    position:relative;
    background:var(--body);
    border-radius:10px;
    height:160px;
    overflow:hidden;                 /* Note bleibt drin bis ge√∂ffnet */
    box-shadow:inset 0 0 0 2px rgba(0,0,0,.05);
    perspective:800px;               /* sanfte 3D f√ºr die Klappe */
  }

  /* Klappe: eigenes Element mit clip-path (robust) */
  .flap{
    position:absolute; left:0; right:0; top:0; height:72px;
    background:var(--flap);
    clip-path:polygon(50% 0%, 100% 100%, 0% 100%);
    transform-origin:50% 0;          /* oben-mittig als Scharnier */
    transform:rotateX(0deg);
    transition:transform .45s ease;   /* Step 1: zuerst */
    backface-visibility:hidden;
    z-index:2;
  }

  /* Herz-Siegel (leichtes Pulse beim √ñffnen) */
  .seal{
    position:absolute; left:50%; top:56%;
    width:28px; height:28px; transform:translate(-50%,-50%) rotate(45deg);
    background:var(--seal); box-shadow:0 1px 6px rgba(0,0,0,.2);
    border-radius:4px; z-index:3;
    transition:transform .25s ease;
  }
  .seal::before,.seal::after{
    content:""; position:absolute; width:28px; height:28px; background:var(--seal); border-radius:50%;
  }
  .seal::before{ top:-14px; left:0; }
  .seal::after{  top:0; left:-14px; }
  .card.open .seal{ transform:translate(-50%,-50%) rotate(45deg) scale(1.08); }

  /* Note (Nachricht) ‚Äì f√§hrt aus dem Umschlag heraus */
  .note{
    position:absolute; left:50%; bottom:0;
    width:78%; max-height:120%;
    transform:translate(-50%, 130%); /* Start: tief im Umschlag, unsichtbar */
    background:var(--paper); color:var(--text);
    border-radius:10px; padding:12px;
    box-shadow:0 6px 16px rgba(0,0,0,.25), 0 0 0 1px rgba(0,0,0,.06) inset;
    z-index:1;                        /* unter Klappe/Siegel */
    transition:transform .45s ease;   /* Step 2: kurz nach der Klappe */
    display:flex; align-items:flex-start; justify-content:flex-start;
  }
  .note p{margin:0; font-size:14px; line-height:1.45}

  /* √ñffnen: 1) Klappe klappt, 2) Note f√§hrt raus (mit kleinem Delay) */
  .card.open .flap{ transform:rotateX(155deg); } /* klappt ‚Äûnach hinten‚Äú */
  .card.open .note{
    transform:translate(-50%, -15%);
    transition-delay:.12s;            /* erst NACH der Klappe losfahren */
  }

  .row{
    display:flex; gap:8px; align-items:center; justify-content:space-between;
  }
  .title{
    margin:0; font-size:16px; font-weight:800; color:#111;
    display:flex; align-items:center; gap:8px;
  }
  .badge{
    font-size:12px; font-weight:700; color:#111;
    background:#fde68a; border:1px dashed var(--accent);
    padding:2px 8px; border-radius:20px;
  }
  .toggle{
    margin-left:auto;
    padding:8px 10px;
    border:0; border-radius:10px; font-weight:800; cursor:pointer;
    background:var(--btn);
  }
  .toggle:hover{background:var(--btn-hover)}
</style>
</head>
<body>

<header>
  <h1>üìú Briefe f√ºr dich</h1>
  <div class="meta" id="meta">‚Äì</div>
  <div class="actions">
    <a href="game-banana.html" class="btn primary">‚¨ÖÔ∏è Zur√ºck zum Spiel</a>
    <button id="reset" class="btn light">Score zur√ºcksetzen</button>
  </div>
</header>

<section class="grid" id="grid"></section>

<script>
(() => {
  // ===== Einstellungen =====
  const TOTAL = 20; // ‚Üê sp√§ter gern 50
  const MESSAGES = Array.from({length: TOTAL}, (_, i) =>
    `Brief #${i+1}: Hier steht deine pers√∂nliche Botschaft ‚ù§Ô∏è`
  );

  // Score aus der Session
  const unlockedCount = parseInt(sessionStorage.getItem('bananaScore') || '0', 10);

  const grid = document.getElementById('grid');
  const meta = document.getElementById('meta');
  meta.textContent = `Freigeschaltet: ${Math.min(unlockedCount, MESSAGES.length)} / ${MESSAGES.length}`;

  MESSAGES.forEach((msg, idx) => {
    const card = document.createElement('div');
    card.className = 'card' + (idx < unlockedCount ? '' : ' locked');

    // Umschlag: enth√§lt Flap (oben), Note (drin) und Siegel (oben)
    const envelope = document.createElement('div');
    envelope.className = 'envelope';

    const flap = document.createElement('div');
    flap.className = 'flap';

    const note = document.createElement('div');
    note.className = 'note';
    const p = document.createElement('p');
    p.textContent = msg;
    note.appendChild(p);

    const seal = document.createElement('div');
    seal.className = 'seal';

    envelope.appendChild(flap);
    envelope.appendChild(note);
    envelope.appendChild(seal);

    // Zeile mit Button
    const row = document.createElement('div');
    row.className = 'row';
    const title = document.createElement('h3');
    title.className = 'title';
    title.innerHTML = `Brief ${idx+1} <span class="badge">${idx < unlockedCount ? 'freigeschaltet' : 'gesperrt'}</span>`;
    const btn = document.createElement('button');
    btn.className = 'toggle';
    btn.textContent = (idx < unlockedCount) ? '√ñffnen' : 'Gesperrt';
    btn.setAttribute('aria-expanded','false');

    if (idx < unlockedCount) {
      btn.addEventListener('click', () => {
        const opening = !card.classList.contains('open');
        card.classList.toggle('open', opening);
        btn.textContent = opening ? 'Schlie√üen' : '√ñffnen';
        btn.setAttribute('aria-expanded', opening ? 'true' : 'false');
      });
    }

    row.appendChild(title);
    row.appendChild(btn);

    card.appendChild(envelope);
    card.appendChild(row);
    grid.appendChild(card);
  });

  // Score zur√ºcksetzen (nur Komfort)
  document.getElementById('reset').addEventListener('click', ()=>{
    sessionStorage.removeItem('bananaScore');
    location.reload();
  });
})();
</script>
</body>
</html>
